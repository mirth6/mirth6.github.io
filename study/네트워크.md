# 네트워크

![image-20200514100434401](img/image-20200514100434401.png)

[TOC]



## TCP

#### TCP정의

- 신뢰성 통신
- Transport Layer
- 오류제어, 흐름제어, 혼잡제어
- streaming, 연결형



#### 네트워크의 문제

- 거리가 멀어지면 파형 변화(신호 감쇠) -> distortion, loss

- 자연재해로 인한 파형 변화 

- 처리 속도 차이

  ex)보내는쪽 100M/sec 받는쪽 10M/sec ->보내는 쪽에서 90M/sec drop => 보내는 쪽이 속도를 10M/sec으로

- 라우터가 100M/sec만 처리 가능한데 거기에 연결되있는 컴퓨터가 여러개(혼잡상황)

=>TCP로 해결



#### 흐름제어, 오류제어 방법

- 패킷을 세그먼트 단위로 나눠서 보냄

- 라우터에 다른 요청이 몰려서 다른 경로를 사용하여 순서가 바뀌는 문제 => 커널개발자가 해결

- stop & wait : ACK받으면 다음 패킷 보냄

- sliding window: 요청을 일단 여러개 보내고 ACK받음

  ![image-20200514103048058](img/image-20200514103048058.png)

	![image-20200514103410447](img/image-20200514103410447.png)

ack가 안오면 time아웃

![image-20200514103700363](img/image-20200514103700363.png)



![image-20200514103844268](img/image-20200514103844268.png)

#### CRC

#### 혼잡제어

- 100M/sec처리하는 라우터에 100M/sec 2개가 요청올때 -> 100M/sec을 드랍해야함 1)두쪽다 50M/sec으로  나누기 
- 바쁘다는 이야기 안해줌
- 패킷 3개 보냄 -> ACK -> 5개 보냄 -> ACK -> 10개 보냄 -> time out -> 7개 보냄
- CWND(congestion window) : 패킷 몇개 보낼지, 보내는데 성공하면 늘리고 실패하면 줄임



#### MSS (Maximum Segment size)

- Maximum Segment size
- TCP에서 전송하는 User Data(L5~L7) 최대 크기
- MSS = MTU - L3 헤더 사이즈 - L4헤더 사이즈 
- cmd>> netsh interface ip show interface 로 MTU사이즈 확인가능
- 연결시 3way handshake로 MSS교환후 작은거 사용
- ![image-20200519102855110](img/image-20200519102855110.png)

- streaming
  - MSS : 14K

    | Send       | Receive    |
    | ---------- | ---------- |
    | 7K, 7K, 1K |            |
    | 7K, 7K, 1K |            |
    | 7K, 7K, 1K |            |
    | 15K        |            |
    | 15K,20K    | 14K,14K,7K |
    |            |            |

  

- d

#### 3way handshake

![]( https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F9910A8345BB0B75F2A0A82)



#### wireshark





###### reference

- https://www.crocus.co.kr/1362