# 시큐어 코딩(Secure Coding)

[TOC]

![image-20200107134252414](.\img\image-20200107134252414.png)



보안약점

- 소프트웨어에서 해킹 등 실제 보안 사고에 악용될 수 있는 보안 취약점의 근본 원인

보안 취약점

- 소프트웨어 실행 시점에 여러 개의 보안 약점 중 실제 침해사고의 원인이 되는 그 보안 약점



#### 소프트웨어 약점 사이트

##### CWE

- http://cwe.mitre.org
- 소프트 웨어 취약점을 사전식으로 분류

##### CVE

- http://cve.mitre.org
- 시간에 따라 감지된 보안 취약점 또는 위험 노출을 정리해둔 목록

##### SANS

- http://www.sans.org/top25-software-errors
- cwe에 등록된 소프트웨어 취약점 중 가장 위험한 25가지 오류를 정리
  - 구성 요소간 안전하지 않은 상호작용(6개)
  - 위험한 자원관리(8개)
  - 허점이 많은 방어(11개)

##### OWASP

- web programming 관련 약점 10개



#### SQL인젝션

- 정상적인 쿼리를 변조, 삽입하여 비정상적인 데이터 베이스에 접근하는 기법
- 적절한 검증 작업이 수행되지 않아서 발생

SQL인젝션 취약성을 가지는 쿼리구조 - 동적쿼리

SQL인젝션 취약성을 가지지 않는 쿼리구조 - 정적쿼리

##### 인젝션 시큐어코딩 기법

![image-20200107144517631](.\img\image-20200107144517631.png)

![image-20200107144550381](.\img\image-20200107144550381.png)

![image-20200107144609410](.\img\image-20200107144609410.png)

![image-20200107144637348](.\img\image-20200107144637348.png)



#### 크로스사이트 스크립트(XSS)

- 검증되지 않은 외부 입력값을 응답의 일부로 사용하는 경우 사용자 브라우저에서 악의적인 스크립트가 실행

- 새션쿠키 훔치기, 웹페이지 변경, ssl암호화 연결 링크 노출, 제한된 웹사이트 접근, dom정책위반

**Reflective XSS**

- 사용자가 요청한 값을 서버에서 검증하지 않고 응답으로 사용하는 경우 발생

- 취약코드

  ![image-20200107150422780](.\img\image-20200107150422780.png)

**Stored XSS**

- 공격자가 서버에 저장한 스크립트를 사용자가 열람하는 경우 스크립트가 다운로드 되어 사용자의 브라우저에서 실행

- 취약코드

  ![image-20200107150509936](.\img\image-20200107150509936.png)

**DOM XSS**

- 자바스크립트로 DOM객체 정보를 사용하여 Document에 write를 수행하는 경우 스크립트가 사용자의 브라우저에서 실행

##### XSS 대응

- 제한적인 입력값 허용

- 제한적인 출력값 허용

- 입력값 필터링

  ![image-20200107150103820](.\img\image-20200107150103820.png)

  ![image-20200107150212775](.\img\image-20200107150212775.png)

  ![image-20200107150249766](.\img\image-20200107150249766.png)



#### 잘못된 접근제어

- 
- 

##### 파라미터 변조

- 서버에게 전달되는 파라미터값을 사용자가 조작하여 변경
- ![image-20200107150655028](.\img\image-20200107150655028.png)

- 취약코드

  ![image-20200107150933568](.\img\image-20200107150933568.png)

  ![image-20200107150955889](.\img\image-20200107150955889.png)



#### 중요정보 노출

- 개인정보를 적절하게 보호하진 않음

- 저장시나 전송시에 암호화 해야함
- 중요정보의 기준 - 정보통신망법, 개인정보보호법 등에 의해 규정되는 정보

- 암호화 공증된거 쓰세요, 알고리즘, 키길이 주의, KISA

  ![image-20200107152415556](.\img\image-20200107152415556.png)



#### 파일업로드/ 다운로드 취약점

업로드

- 파일의 사이즈, 타입에 제한을 걸어줘야함 (.exe)
- 업로드된 파일 외부에서 직접적으로 접근 가능한 경우 취약
- 웹 쉘 취약

다운로드

- 스파이웨어, 권한을 우회하여 파일을 다운로드 받을 수 있는 취약점



#### 행정안전부 SW보안 약점 제거 기준

1. 입력데이터 검증 및 표현(15)
2. 보안기능(16)
3. 시간 및 상태(2)
4. 에러처리(3)
5. 코드오류(4)
6. 캡슐화(5)
7. API 오용(2)



csrf